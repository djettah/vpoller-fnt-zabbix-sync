<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.4</version>
    <date>2020-05-07T15:15:37Z</date>
    <groups>
        <group>
            <name>Templates/Applications</name>
        </group>
        <group>
            <name>Templates/FNT</name>
        </group>
        <group>
            <name>Templates/VFZSync</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template App FNT Command</template>
            <name>Template App FNT Command</name>
            <groups>
                <group>
                    <name>Templates/Applications</name>
                </group>
                <group>
                    <name>Templates/VFZSync</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>FNT Command Frontend</name>
                    <type>HTTP_AGENT</type>
                    <key>fnt.command.frontend</key>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <url>{$FNT_COMMAND_URL}</url>
                    <triggers>
                        <trigger>
                            <expression>{str(Command - FNT GmbH)}=0</expression>
                            <name>FNT Command Frontend unavailable</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$FNT_COMMAND_URL}</macro>
                    <value>http://172.20.76.121:9090</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template App VFZ Sync</template>
            <name>Template App VFZ Sync</name>
            <groups>
                <group>
                    <name>Templates/VFZSync</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Stats</name>
                </application>
                <application>
                    <name>VFZ Sync</name>
                </application>
                <application>
                    <name>_internal</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Daily Report Information</name>
                    <type>EXTERNAL</type>
                    <key>get-email-info.py[&quot;{$API_USER}&quot;, &quot;{$API_PASS}&quot;, &quot;{$API_URL}&quot;]</key>
                    <delay>0m;wd1-7h7</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>Stats</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{nodata(60)}=0</expression>
                            <name>Email Scheduler (daily reports)</name>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>VFZ Sync Send [groupupdate]</name>
                    <type>HTTP_AGENT</type>
                    <key>vfzsync.send[groupupdate]</key>
                    <delay>5m</delay>
                    <history>1h</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>_internal</name>
                        </application>
                    </applications>
                    <url>https://{$VFZ_HOST}/vfzsync/api/send/run</url>
                    <query_fields>
                        <query_field>
                            <name>mode</name>
                            <value>groupupdate</value>
                        </query_field>
                        <query_field>
                            <name>async</name>
                        </query_field>
                    </query_fields>
                </item>
                <item>
                    <name>VFZ Sync Runner ($1)</name>
                    <type>HTTP_AGENT</type>
                    <key>vfzsync.sync.runner[fnt-zabbix]</key>
                    <delay>15m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>_internal</name>
                        </application>
                    </applications>
                    <url>https://{$VFZ_HOST}/vfzsync/api/sync/run?async&amp;mode=fnt-zabbix</url>
                </item>
                <item>
                    <name>VFZ Sync Runner ($1)</name>
                    <type>HTTP_AGENT</type>
                    <key>vfzsync.sync.runner[vpoller-fnt]</key>
                    <delay>6h</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>_internal</name>
                        </application>
                    </applications>
                    <url>https://{$VFZ_HOST}/vfzsync/api/sync/run</url>
                    <query_fields>
                        <query_field>
                            <name>async</name>
                        </query_field>
                        <query_field>
                            <name>mode</name>
                            <value>vpoller-fnt</value>
                        </query_field>
                    </query_fields>
                </item>
                <item>
                    <name>VFZ Sync Stats</name>
                    <type>HTTP_AGENT</type>
                    <key>vfzsync.sync.stats</key>
                    <delay>5m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>_internal</name>
                        </application>
                    </applications>
                    <url>https://{$VFZ_HOST}/vfzsync/api/sync/stats</url>
                    <query_fields>
                        <query_field>
                            <name>mode</name>
                            <value>vs-stats</value>
                        </query_field>
                    </query_fields>
                </item>
                <item>
                    <name>Virtual Servers stats: deleted</name>
                    <type>DEPENDENT</type>
                    <key>vfzsync.sync.stats.vs_deleted</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>Stats</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.vs_deleted</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>15m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>vfzsync.sync.stats</key>
                    </master_item>
                </item>
                <item>
                    <name>Virtual Servers stats: new</name>
                    <type>DEPENDENT</type>
                    <key>vfzsync.sync.stats.vs_new</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <applications>
                        <application>
                            <name>Stats</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.vs_new</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>15m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>vfzsync.sync.stats</key>
                    </master_item>
                </item>
                <item>
                    <name>VFZ Sync Status</name>
                    <type>HTTP_AGENT</type>
                    <key>vfzsync.sync.status</key>
                    <delay>5m</delay>
                    <history>1h</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>_internal</name>
                        </application>
                    </applications>
                    <url>https://{$VFZ_HOST}/vfzsync/api/sync/status</url>
                    <triggers>
                        <trigger>
                            <expression>{nodata({$VFZ_SYNC_THRESHOLD})}=1</expression>
                            <name>VFZ Sync not running</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>VFZ Sync Status Date ($1)</name>
                    <type>DEPENDENT</type>
                    <key>vfzsync.sync.status.date[fnt-zabbix]</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>VFZ Sync</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.sync.['fnt-zabbix'].date</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>vfzsync.sync.status</key>
                    </master_item>
                </item>
                <item>
                    <name>VFZ Sync Status Date ($1)</name>
                    <type>DEPENDENT</type>
                    <key>vfzsync.sync.status.date[vpoller-fnt]</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>VFZ Sync</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.sync.['vpoller-fnt'].date</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>vfzsync.sync.status</key>
                    </master_item>
                </item>
                <item>
                    <name>VFZ Sync Status ($1)</name>
                    <type>DEPENDENT</type>
                    <key>vfzsync.sync.status[fnt-zabbix]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>VFZ Sync</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.sync.['fnt-zabbix'].status</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>vfzsync.sync.status</key>
                    </master_item>
                </item>
                <item>
                    <name>VFZ Sync Status ($1)</name>
                    <type>DEPENDENT</type>
                    <key>vfzsync.sync.status[vpoller-fnt]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>VFZ Sync</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.sync.['vpoller-fnt'].status</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>vfzsync.sync.status</key>
                    </master_item>
                </item>
                <item>
                    <name>VFZ Sync Updater ($1)</name>
                    <type>HTTP_AGENT</type>
                    <key>vfzsync.update.runner[random]</key>
                    <delay>30m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>_internal</name>
                        </application>
                    </applications>
                    <url>https://{$VFZ_HOST}/vfzsync/api/update/run</url>
                    <query_fields>
                        <query_field>
                            <name>async</name>
                        </query_field>
                        <query_field>
                            <name>mode</name>
                            <value>random</value>
                        </query_field>
                        <query_field>
                            <name>cSdiNewServer</name>
                            <value>0</value>
                        </query_field>
                        <query_field>
                            <name>cSdiMonitoring</name>
                            <value>80</value>
                        </query_field>
                        <query_field>
                            <name>cSdiMonitoringSnmp</name>
                            <value>1</value>
                        </query_field>
                        <query_field>
                            <name>cSdiBackupNeeded</name>
                            <value>20</value>
                        </query_field>
                        <query_field>
                            <name>cSdiNoShutdown</name>
                            <value>100</value>
                        </query_field>
                        <query_field>
                            <name>percent</name>
                            <value>15</value>
                        </query_field>
                        <query_field>
                            <name>create_fake</name>
                            <value>0</value>
                        </query_field>
                    </query_fields>
                </item>
                <item>
                    <name>VFZ Sync Update Date ($1)</name>
                    <type>DEPENDENT</type>
                    <key>vfzsync.update.status.date[random]</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>VFZ Sync</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.update.['random'].date</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>vfzsync.sync.status</key>
                    </master_item>
                </item>
                <item>
                    <name>VFZ Sync Update Status ($1)</name>
                    <type>DEPENDENT</type>
                    <key>vfzsync.update.status[random]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>VFZ Sync</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.update.['random'].status</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>vfzsync.sync.status</key>
                    </master_item>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$VFZ_HOST}</macro>
                    <value>nginx</value>
                </macro>
                <macro>
                    <macro>{$VFZ_SYNC_PERIOD}</macro>
                    <value>1h</value>
                </macro>
                <macro>
                    <macro>{$VFZ_SYNC_THRESHOLD}</macro>
                    <value>7h</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>Template FNT Virtual Server</template>
            <name>Template FNT Virtual Server</name>
            <groups>
                <group>
                    <name>Templates/FNT</name>
                </group>
                <group>
                    <name>Templates/VFZSync</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>(Internal) backup problem</name>
                </application>
                <application>
                    <name>(Internal) icmp problem</name>
                </application>
                <application>
                    <name>(Internal) power problem</name>
                </application>
                <application>
                    <name>(Internal) snmp problem</name>
                </application>
                <application>
                    <name>Backup</name>
                </application>
                <application>
                    <name>CPU</name>
                </application>
                <application>
                    <name>cSdiBackupNeeded</name>
                </application>
                <application>
                    <name>cSdiMonitoring</name>
                </application>
                <application>
                    <name>cSdiMonitoringSnmp</name>
                </application>
                <application>
                    <name>cSdiNoShutdown</name>
                </application>
                <application>
                    <name>Datastores</name>
                </application>
                <application>
                    <name>Filesystem</name>
                </application>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>Hardware</name>
                </application>
                <application>
                    <name>Hypervisor</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>Network</name>
                </application>
                <application>
                    <name>Performance</name>
                </application>
                <application>
                    <name>Status</name>
                </application>
                <application>
                    <name>VMware Tools</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Backup date</name>
                    <type>DEPENDENT</type>
                    <key>backup.date</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <units>unixtime</units>
                    <applications>
                        <application>
                            <name>(Internal) backup problem</name>
                        </application>
                        <application>
                            <name>cSdiBackupNeeded</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>REGEX</type>
                            <params>Time: \[(\d\d)\.(\d\d)\.(\d\d\d\d) (.*?)\]
\3-\2-\1 \4</params>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>1970-01-02 00:00:00</error_handler_params>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>var backupDate = new Date(value);
var date_local=new Date();
var tz_offset = date_local.getTimezoneOffset() * 60;
return Math.floor(backupDate/1000 + tz_offset)</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>vpoller[&quot;vm.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;config.annotation&quot;, &quot;null&quot;]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>({now()} - {last()} &gt;= {$BACKUP_AGE_WARN})</expression>
                            <name>Backup Date is more than {$BACKUP_AGE_WARN} ago or unknown</name>
                            <opdata>Date: {ITEM.LASTVALUE1}</opdata>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>FNT_Flag</tag>
                                    <value>cSdiBackupNeeded</value>
                                </tag>
                                <tag>
                                    <tag>IP</tag>
                                    <value>{HOST.CONN}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Backup date ago</name>
                    <type>DEPENDENT</type>
                    <key>backup.date.ago</key>
                    <delay>0</delay>
                    <history>2h</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <units>s</units>
                    <applications>
                        <application>
                            <name>cSdiBackupNeeded</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>var now = Math.round(Date.now() / 1000);
return now - value;</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>backup.date</key>
                    </master_item>
                </item>
                <item>
                    <name>ICMP loss</name>
                    <type>SIMPLE</type>
                    <key>icmppingloss[,{$ICMP_PACKETS},{$ICMP_INTERVAL},{$ICMP_SIZE},{$ICMP_TIMEOUT}]</key>
                    <history>1w</history>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <applications>
                        <application>
                            <name>(Internal) icmp problem</name>
                        </application>
                        <application>
                            <name>cSdiMonitoring</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{min({$ICMP_THRESHOLD})}&gt;={$ICMP_LOSS_WARN}</expression>
                            <name>ICMP high ping loss</name>
                            <opdata>Loss: {ITEM.LASTVALUE1}</opdata>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Virtual machine is powered off</name>
                                    <expression>{Template FNT Virtual Server:vpoller[&quot;vm.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;runtime.powerState&quot;, &quot;null&quot;].iregexp(poweredOff)}=1</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>FNT_Flag</tag>
                                    <value>cSdiMonitoring</value>
                                </tag>
                                <tag>
                                    <tag>IP</tag>
                                    <value>{HOST.CONN}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>ip address information</name>
                    <type>TRAP</type>
                    <key>ip.address</key>
                    <delay>0</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Power State</name>
                    <type>DEPENDENT</type>
                    <key>powerState.integer</key>
                    <delay>0</delay>
                    <history>2h</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <applications>
                        <application>
                            <name>cSdiNoShutdown</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>if (value == '&quot;poweredOn&quot;')
    return 100
return 0</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>vpoller[&quot;vm.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;runtime.powerState&quot;, &quot;null&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>System name</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>1.3.6.1.2.1.1.5.0</snmp_oid>
                    <key>system.name</key>
                    <delay>5m</delay>
                    <history>2h</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>CHAR</value_type>
                    <description>MIB: SNMPv2-MIB&#13;
An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.</description>
                    <inventory_link>NAME</inventory_link>
                    <applications>
                        <application>
                            <name>(Internal) snmp problem</name>
                        </application>
                        <application>
                            <name>cSdiMonitoringSnmp</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{nodata({$SNMP_THRESHOLD})}=1</expression>
                            <name>SNMP unavailable</name>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <description>SNMP is not available for polling. Please check device connectivity and SNMP settings.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Virtual machine is powered off</name>
                                    <expression>{Template FNT Virtual Server:vpoller[&quot;vm.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;runtime.powerState&quot;, &quot;null&quot;].iregexp(poweredOff)}=1</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>FNT_Flag</tag>
                                    <value>cSdiMonitoringSnmp</value>
                                </tag>
                                <tag>
                                    <tag>IP</tag>
                                    <value>{HOST.CONN}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>trigger.status[cSdiBackupNeeded]</name>
                    <type>TRAP</type>
                    <key>trigger.status[cSdiBackupNeeded]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Trigger Status</name>
                    </valuemap>
                </item>
                <item>
                    <name>trigger.status[cSdiMonitoringSnmp]</name>
                    <type>TRAP</type>
                    <key>trigger.status[cSdiMonitoringSnmp]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Trigger Status</name>
                    </valuemap>
                </item>
                <item>
                    <name>trigger.status[cSdiMonitoring]</name>
                    <type>TRAP</type>
                    <key>trigger.status[cSdiMonitoring]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Trigger Status</name>
                    </valuemap>
                </item>
                <item>
                    <name>trigger.status[cSdiNoShutdown]</name>
                    <type>TRAP</type>
                    <key>trigger.status[cSdiNoShutdown]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Trigger Status</name>
                    </valuemap>
                </item>
                <item>
                    <name>VFZ Sync Send [ipaddress]</name>
                    <type>HTTP_AGENT</type>
                    <key>vfzsync.send[ipaddress]</key>
                    <delay>5h</delay>
                    <history>1h</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <url>https://{$VFZ_HOST}/vfzsync/api/send/run</url>
                    <query_fields>
                        <query_field>
                            <name>mode</name>
                            <value>trapper</value>
                        </query_field>
                        <query_field>
                            <name>async</name>
                        </query_field>
                        <query_field>
                            <name>host</name>
                            <value>{HOST.HOST}</value>
                        </query_field>
                        <query_field>
                            <name>key</name>
                            <value>ip.address</value>
                        </query_field>
                        <query_field>
                            <name>status</name>
                            <value>{HOST.CONN}</value>
                        </query_field>
                    </query_fields>
                </item>
                <item>
                    <name>Storage provisioned</name>
                    <type>CALCULATED</type>
                    <key>vm.storage.provisioned</key>
                    <delay>5m</delay>
                    <status>DISABLED</status>
                    <units>B</units>
                    <params>last(&quot;vpoller[\&quot;vm.get\&quot;, \&quot;{$VSPHERE.HOST}\&quot;, \&quot;{HOST.NAME}\&quot;, \&quot;summary.storage.committed\&quot;, \&quot;null\&quot;]&quot;) + last(&quot;vpoller[\&quot;vm.get\&quot;, \&quot;{$VSPHERE.HOST}\&quot;, \&quot;{HOST.NAME}\&quot;, \&quot;summary.storage.uncommitted\&quot;, \&quot;null\&quot;]&quot;)</params>
                    <applications>
                        <application>
                            <name>Datastores</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Annotation</name>
                    <type>SIMPLE</type>
                    <key>vpoller[&quot;vm.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;config.annotation&quot;, &quot;null&quot;]</key>
                    <delay>1h</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>cSdiBackupNeeded</name>
                        </application>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Power State</name>
                    <type>SIMPLE</type>
                    <key>vpoller[&quot;vm.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;runtime.powerState&quot;, &quot;null&quot;]</key>
                    <delay>5m</delay>
                    <history>2h</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>(Internal) power problem</name>
                        </application>
                        <application>
                            <name>cSdiNoShutdown</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{iregexp(poweredOff)}=1</expression>
                            <name>Virtual machine is powered off</name>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <description>Virtual Machine {HOST.NAME} is powered off&#13;
&#13;
Virtual Machine: {HOST.NAME}&#13;
vSphere Host: {$VSPHERE.HOST}</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>FNT_Flag</tag>
                                    <value>cSdiNoShutdown</value>
                                </tag>
                                <tag>
                                    <tag>IP</tag>
                                    <value>{HOST.CONN}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Storage committed</name>
                    <type>SIMPLE</type>
                    <key>vpoller[&quot;vm.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;summary.storage.committed&quot;, &quot;null&quot;]</key>
                    <delay>1h</delay>
                    <history>1d</history>
                    <status>DISABLED</status>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Datastores</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Storage uncommitted</name>
                    <type>SIMPLE</type>
                    <key>vpoller[&quot;vm.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;summary.storage.uncommitted&quot;, &quot;null&quot;]</key>
                    <delay>1h</delay>
                    <history>1d</history>
                    <status>DISABLED</status>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Datastores</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Storage unshared</name>
                    <type>SIMPLE</type>
                    <key>vpoller[&quot;vm.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;summary.storage.unshared&quot;, &quot;null&quot;]</key>
                    <delay>1h</delay>
                    <history>1d</history>
                    <status>DISABLED</status>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Datastores</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SNMP agent availability</name>
                    <type>INTERNAL</type>
                    <key>zabbix[host,snmp,available]</key>
                    <history>1d</history>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Discover VMware Datastores on Virtual Machine</name>
                    <type>SIMPLE</type>
                    <key>vpoller[&quot;vm.datastore.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;null&quot;, &quot;null&quot;]</key>
                    <delay>3600</delay>
                    <status>DISABLED</status>
                    <lifetime>7d</lifetime>
                    <description>Discover VMware datastores used by the Virtual Machine</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Datastore &quot;{#VSPHERE.VM.DATASTORE.NAME}&quot; is used by Virtual Machine</name>
                            <type>SIMPLE</type>
                            <key>vpoller.echo[&quot;{#VSPHERE.VM.DATASTORE.INFO.URL}&quot;]</key>
                            <delay>3600</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <applications>
                                <application>
                                    <name>Datastores</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Filesystem Discovery</name>
                    <type>SIMPLE</type>
                    <key>vpoller[&quot;vm.disk.discover&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;null&quot;, &quot;null&quot;]</key>
                    <delay>60</delay>
                    <status>DISABLED</status>
                    <lifetime>7d</lifetime>
                    <description>Discovery of filesystems on a VMware Virtual Machine</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Capacity of {#VSPHERE.VM.DISKPATH} filesystem</name>
                            <type>SIMPLE</type>
                            <key>vpoller[&quot;vm.disk.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;capacity&quot;, {#VSPHERE.VM.DISKPATH}]</key>
                            <delay>300</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Free space of {#VSPHERE.VM.DISKPATH} filesystem</name>
                            <type>SIMPLE</type>
                            <key>vpoller[&quot;vm.disk.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;freeSpace&quot;, {#VSPHERE.VM.DISKPATH}]</key>
                            <delay>300</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Free space of {#VSPHERE.VM.DISKPATH} filesystem (percentage)</name>
                            <type>CALCULATED</type>
                            <key>vpoller[&quot;vm.disk.get&quot;, &quot;{$VSPHERE.HOST}&quot;, &quot;{HOST.NAME}&quot;, &quot;freeSpacePercentage&quot;, {#VSPHERE.VM.DISKPATH}]</key>
                            <delay>300</delay>
                            <history>7d</history>
                            <trends>30d</trends>
                            <value_type>FLOAT</value_type>
                            <params>last(&quot;vpoller[\&quot;vm.disk.get\&quot;, \&quot;{$VSPHERE.HOST}\&quot;, \&quot;{HOST.NAME}\&quot;, \&quot;freeSpace\&quot;, {#VSPHERE.VM.DISKPATH}]&quot;) / last(&quot;vpoller[\&quot;vm.disk.get\&quot;, \&quot;{$VSPHERE.HOST}\&quot;, \&quot;{HOST.NAME}\&quot;, \&quot;capacity\&quot;, {#VSPHERE.VM.DISKPATH}]&quot;) * 100</params>
                            <applications>
                                <application>
                                    <name>Filesystem</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min(5)}&lt;20</expression>
                                    <name>Less than 20% of free space on {#VSPHERE.VM.DISKPATH} at {HOST.NAME}</name>
                                    <priority>HIGH</priority>
                                    <description>Less than 20% of free space on {#VSPHERE.VM.DISKPATH} at {HOST.NAME}&#13;
&#13;
Virtual Machine: {HOST.NAME}&#13;
Free space of {#VSPHERE.VM.DISKPATH}: {ITEM.LASTVALUE}%&#13;
vSphere Host: {$VSPHERE.HOST}</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$API_PASS}</macro>
                    <value>zabbix</value>
                </macro>
                <macro>
                    <macro>{$API_URL}</macro>
                    <value>https://zabbix-web/api_jsonrpc.php</value>
                </macro>
                <macro>
                    <macro>{$API_USER}</macro>
                    <value>Admin</value>
                </macro>
                <macro>
                    <macro>{$BACKUP_AGE_WARN}</macro>
                    <value>3d</value>
                </macro>
                <macro>
                    <macro>{$GROUPID_BACKUP}</macro>
                    <value>31</value>
                </macro>
                <macro>
                    <macro>{$GROUPID_ICMP}</macro>
                    <value>28</value>
                </macro>
                <macro>
                    <macro>{$GROUPID_POWER}</macro>
                    <value>30</value>
                </macro>
                <macro>
                    <macro>{$GROUPID_SNMP}</macro>
                    <value>29</value>
                </macro>
                <macro>
                    <macro>{$ICMP_INTERVAL}</macro>
                    <value>1000</value>
                </macro>
                <macro>
                    <macro>{$ICMP_LOSS_WARN}</macro>
                    <value>33</value>
                </macro>
                <macro>
                    <macro>{$ICMP_PACKETS}</macro>
                    <value>3</value>
                </macro>
                <macro>
                    <macro>{$ICMP_SIZE}</macro>
                    <value>56</value>
                </macro>
                <macro>
                    <macro>{$ICMP_THRESHOLD}</macro>
                    <value>5m</value>
                </macro>
                <macro>
                    <macro>{$ICMP_TIMEOUT}</macro>
                    <value>3000</value>
                </macro>
                <macro>
                    <macro>{$SNMP_THRESHOLD}</macro>
                    <value>17m</value>
                </macro>
                <macro>
                    <macro>{$VFZ_HOST}</macro>
                    <value>nginx</value>
                </macro>
            </macros>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>({Template App VFZ Sync:vfzsync.sync.status[fnt-zabbix].iregexp(completed,{$VFZ_SYNC_THRESHOLD})}=0) or &#13;
({Template App VFZ Sync:vfzsync.sync.status.date[fnt-zabbix].now()} - {Template App VFZ Sync:vfzsync.sync.status.date[fnt-zabbix].last()} &gt; {$VFZ_SYNC_THRESHOLD})</expression>
            <name>VFZ Sync (fnt-zabbix) not completed in last {$VFZ_SYNC_THRESHOLD}</name>
            <priority>AVERAGE</priority>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <expression>({Template App VFZ Sync:vfzsync.sync.status[vpoller-fnt].iregexp(completed,{$VFZ_SYNC_THRESHOLD})}=0) or &#13;
(({Template App VFZ Sync:vfzsync.sync.status.date[vpoller-fnt].now()} - {Template App VFZ Sync:vfzsync.sync.status.date[vpoller-fnt].last()}) &gt; {$VFZ_SYNC_THRESHOLD})</expression>
            <name>VFZ Sync (vpoller-fnt) not completed in last {$VFZ_SYNC_THRESHOLD}</name>
            <priority>AVERAGE</priority>
            <manual_close>YES</manual_close>
        </trigger>
    </triggers>
    <value_maps>
        <value_map>
            <name>Trigger Status</name>
            <mappings>
                <mapping>
                    <value>-1</value>
                    <newvalue>Disabled</newvalue>
                </mapping>
                <mapping>
                    <value>0</value>
                    <newvalue>ОК</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Problem</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
